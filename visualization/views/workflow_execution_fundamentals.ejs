<%- include("partials/header", {activity: 'Workflow Execution Fundamentals'}); %>

<%- include("partials/inputs"); %>

<%- include("partials/simulation_parameters_form_start"); %>

    <div class="form-group">
      <label for="compute_speed">Compute speed of hpc.edu in TFlop/sec</label>
      <input type="number" class="form-control" id="compute-speed" placeholder="10" value="" min="1" max="99" step="1" required>
      <div class="invalid-feedback">
        Please provide a compute speed in the range [1, 99]
      </div>
    </div>

<%- include("partials/simulation_parameters_form_end"); %>

<%- include("partials/simulation_output"); %>

<%- include("partials/workflow_execution_graph"); %>

<%- include("partials/workflow_execution_data"); %>

<script src="scripts/workflow_execution_fundamentals.js" type="text/javascript"></script>

<script>
    // Setup zoom for the platform svg and center it
    let svg = d3.select("#cyberinfrastructure");
    let height = svg.attr("height").slice(0, -2);

    let inner = svg.select("g");

    // Set up zoom support
    let zoom = d3.zoom().on("zoom", function() {
        inner.attr("transform", d3.event.transform);
    });
    svg.call(zoom);

    // Center the graph
    let initialScale = 0.6;
    svg.call(zoom.transform,
        d3.zoomIdentity.translate(20, 40).scale(initialScale));


    svg.attr('height', height);

    // Display the workflow DAG
    var workflow_graph_json = JSON.parse('<%- JSON.stringify(workflow_graph_json) %>');
    generate_workflow_dag(workflow_graph_json);
</script>

<%- include("partials/footer"); %>
